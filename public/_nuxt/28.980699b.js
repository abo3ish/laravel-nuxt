(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{220:function(e,r,t){"use strict";t.r(r);t(191),t(53),t(30);var n=t(10),o=t(6),d=t(47),c=t.n(d),l=t(323),v=t(104),f={layout:"admin",middleware:"auth",head:function(){return{title:this.order.uuid}},components:{LabelInputText:l.a,Loading:v.default},data:function(){return{nameState:null,serviceProviderTypes:[],order:{id:"",uuid:"",user:{},status:{},area:{},address:"",type:"",services:[],drugs:[],service_provider:{},service_provider_type:{},prices:{}},serviceProviderOptions:[],drugOptions:[],statusOptions:[],form:new c.a({service_provider_id:"",status:"",price_to_pay:""}),drugsFields:["name","price_to_pay","quantity","actions"],drugOrder:{id:"",name:"",price_to_pay:"",drug_id:"",quantity:""}}},mounted:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.fetchData();case 2:e.fetchOrderStatuses();case 3:case"end":return r.stop()}}),r)})))()},methods:{fetchData:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.$axios.$get("orders/"+e.$route.params.id).then((function(r){e.form.service_provider_id=r.service_provider?r.service_provider.id:null,e.form.price_to_pay=r.prices.price_to_pay,e.form.status=r.status.code,e.order=r,e.statusOptions.push(r.status),r.service_provider?e.serviceProviderOptions.push(r.service_provider):e.searchForServiceProviders("",e.order.service_provider_type.id,e.order.area.id)}));case 2:case"end":return r.stop()}}),r)})))()},update:function(){var e=this;this.form.put("/orders/"+this.$route.params.id,this.form).then((function(r){e.order=r.data})),this.$notify({group:"feedback",title:this.$t("service_provider_updated_sucessfully"),type:"success"})},fetchOrderStatuses:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.$axios.$get("order-statuses").then((function(r){e.statusOptions=r}));case 2:case"end":return r.stop()}}),r)})))()},fetchServiceProviderOptions:function(e,r){var t=this;0!==e.length&&(r(!0),setTimeout((function(){t.searchForServiceProviders(e,t.order.service_provider_type.id,t.order.area.id),r(!1)}),300))},searchForServiceProviders:function(){var e=arguments,r=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:"",e.length>1&&void 0!==e[1]?e[1]:null,e.length>2&&void 0!==e[2]?e[2]:null,t.next=5,r.$axios.$get("service-providers",{params:{name:n}}).then((function(e){r.serviceProviderOptions=e.data}));case 5:case"end":return t.stop()}}),t)})))()},fetchDrugOptions:function(e,r){var t=this;0!==e.length&&(r(!0),setTimeout((function(){t.searchForDrugs(e),r(!1)}),300))},searchForDrugs:function(){var e=arguments,r=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:"",t.next=3,r.$axios.$get("drugs",{params:{name:n}}).then((function(e){r.drugOptions=e.drugs}));case 3:case"end":return t.stop()}}),t)})))()},resetModal:function(){this.drugOrder={}},StoreDrugOrder:function(e){var r=this;this.drugOrder.order_id=this.order.id,this.$axios.$post("drug-order",this.drugOrder).then((function(e){r.order.drugs.push(e)}))},showDrugOrder:function(e){var r=this,t=this.order.drugs.find((function(r){return r.id===e}));this.drugOrder=t,this.$axios.$get("drugs/".concat(this.drugOrder.drug_id)).then((function(e){r.drugOptions.push(e)}))},updateDrugOrder:function(e){var r=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.$axios.$put("drug-order/".concat(e),r.drugOrder).then((function(t){o.default.set(r.order.drugs,r.order.drugs.findIndex((function(r){return r.id===e})),t)}));case 2:case"end":return t.stop()}}),t)})))()},handleDrugOrder:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.$refs.form.checkValidity()&&(e?this.updateDrugOrder(e):this.StoreDrugOrder(),this.$refs["drug-order"].hide())},deleteItem:function(e,r){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$axios.$delete("drug-order/".concat(e)).then((function(r){r&&o.default.delete(t.order.drugs,t.order.drugs.findIndex((function(r){return r.id===e})))}));case 2:case"end":return r.stop()}}),r)})))()}}},_=(t(347),t(12)),component=Object(_.a)(f,(function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[e.order.id?e._e():t("loading"),e._v(" "),t("header-info",{attrs:{name:"orders",navigation:[{name:"home",link:"dashboard"},{name:"orders",link:"orders"},{name:e.order.uuid,link:"",trans:!1}]}}),e._v(" "),t("div",{staticClass:"row"},[t("div",{staticClass:"col-md-12"},[t("div",{staticClass:"card card-primary"},[t("div",{staticClass:"card-header"},[t("h3",{staticClass:"card-title"},[t("n-link",{attrs:{to:{name:"show-order"}}},[t("button",{staticClass:"btn btn-outline-light float-left"},[e._v("\n                "+e._s(e.$t("show"))+"\n              ")])])],1)]),e._v(" "),t("form",{attrs:{role:"form"},on:{submit:function(r){return r.preventDefault(),e.update()}}},[t("div",{staticClass:"card-body"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"balance"}},[e._v(e._s(e.$t("user"))+" : ")]),e._v(" "),t("code",[e._v("\n                "+e._s(e.order.user.name)+" "),t("br")])]),e._v(" "),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"balance"}},[e._v(e._s(e.$t("type"))+" : ")]),e._v(" "),t("code",[e._v("\n                "+e._s(e.order.type)+"\n              ")])]),e._v(" "),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"orders"}},[e._v(e._s(e.$t("orders"))+" : ")]),e._v(" "),e._l(e.order.services,(function(r){return t("b-badge",{key:r.id,staticClass:"p-2 m-2 w-30",attrs:{pill:"",variant:"primary"}},[e._v("\n                "+e._s(r.title)+"\n              ")])})),e._v(" "),e._l(e.order.drugs,(function(r){return t("b-badge",{key:r.id,attrs:{pill:"",variant:"info"}},[e._v("\n                "+e._s(r.name)+"\n              ")])}))],2),e._v(" "),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"balance"}},[e._v(e._s(e.$t("status"))+" : ")]),e._v(" "),t("code",[e._v("\n                "+e._s(e.order.status.string)+" "),t("br")])]),e._v(" "),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"balance"}},[e._v(e._s(e.$t("service_provider_type"))+" : ")]),e._v(" "),t("code",[e._v("\n                "+e._s(e.order.service_provider_type.title)+" "),t("br")])]),e._v(" "),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"balance"}},[e._v(e._s(e.$t("service_provider"))+" : ")]),e._v(" "),t("code",[e._v("\n                "+e._s(e.order.service_provider?e.order.service_provider.name:e.$t("not_assigned"))+" "),t("br")])]),e._v(" "),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"balance"}},[e._v(e._s(e.$t("address"))+" : ")]),e._v(" "),t("code",{attrs:{id:"address"}},[e._v("\n                "+e._s(e.order.address)+" "),t("br")])]),e._v(" "),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"balance"}},[e._v(e._s(e.$t("area"))+" : ")]),e._v(" "),t("code",{attrs:{id:"area"}},[e._v("\n                "+e._s(e.order.area.name)+" "),t("br")])]),e._v(" "),t("form",{on:{submit:function(r){return r.preventDefault(),e.update()}}},[t("div",{staticClass:"form-group"},[t("label",{attrs:{id:"service-provider"}},[e._v(e._s(e.$t("service_provider")))]),e._v(" "),t("v-select",{attrs:{options:e.serviceProviderOptions,filterable:!1,reduce:function(e){return e.id},label:"name"},on:{search:e.fetchServiceProviderOptions},scopedSlots:e._u([{key:"option",fn:function(r){var n=r.name;return[t("div",{staticClass:"d-center"},[e._v("\n                      "+e._s(n)+"\n                      "),t("img",{attrs:{src:"https://via.placeholder.com/40/40"}})])]}},{key:"selected-option",fn:function(r){var n=r.name;return[t("div",{staticClass:"selected d-center"},[t("strong",[e._v("\n                        "+e._s(n)+"\n                      ")]),e._v(" "),t("img",{attrs:{src:"https://via.placeholder.com/40/40"}})])]}}]),model:{value:e.form.service_provider_id,callback:function(r){e.$set(e.form,"service_provider_id",r)},expression:"form.service_provider_id"}})],1),e._v(" "),t("div",{staticClass:"form-group"},[t("label",{attrs:{id:"status"}},[e._v(e._s(e.$t("status")))]),e._v(" "),t("v-select",{attrs:{options:e.statusOptions,filterable:!1,reduce:function(e){return e.code},label:"code"},scopedSlots:e._u([{key:"option",fn:function(r){var n=r.string;return[t("div",{staticClass:"d-center"},[e._v("\n                      "+e._s(n)+"\n                    ")])]}},{key:"selected-option",fn:function(r){var n=r.string;return[t("div",{staticClass:"selected d-center"},[t("strong",[e._v("\n                        "+e._s(n)+"\n                      ")]),e._v(" "),t("span")])]}}]),model:{value:e.form.status,callback:function(r){e.$set(e.form,"status",r)},expression:"form.status"}})],1),e._v(" "),t("div",{staticClass:"card-footer"},[t("v-button",{attrs:{loading:e.form.busy,type:"success"}},[e._v("\n                  "+e._s(e.$t("save"))+"\n                ")])],1)])])])]),e._v(" "),"pharmacy"==e.order.type?t("div",{staticClass:"card card-primary"},[t("div",{staticClass:"card card-header"},[t("div",{staticClass:"card-title"},[e._v("\n            Drugs\n            "),t("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-center",modifiers:{"modal-center":!0}}],staticClass:"btn btn-outline-light float-left",attrs:{variant:"primary"}},[e._v("\n              "+e._s(e.$t("add_new"))+"\n            ")]),e._v(" "),t("b-modal",{ref:"drug-order",attrs:{id:"modal-center",size:"lg",centered:"",state:e.nameState,title:"منتج جديد"},on:{hidden:e.resetModal},scopedSlots:e._u([{key:"modal-footer",fn:function(r){var n=r.cancel;return[e.drugOrder.id?t("b-button",{attrs:{size:"sm",variant:"success"},on:{click:function(r){return e.handleDrugOrder(e.drugOrder.id)}}},[e._v("\n                  عدل\n                ")]):t("b-button",{attrs:{size:"sm",variant:"success"},on:{click:function(r){return e.handleDrugOrder()}}},[e._v("\n                  اضف\n                ")]),e._v(" "),t("b-button",{attrs:{size:"sm",variant:"danger"},on:{click:function(e){return n()}}},[e._v("\n                  اغلق\n                ")])]}}],null,!1,946467264)},[t("form",{ref:"form",on:{submit:function(r){return r.stopPropagation(),r.preventDefault(),e.handleDrugOrder(e.drugOrder.id)}}},[t("div",{staticClass:"form-group"},[t("label",{attrs:{id:"drug"}},[e._v(e._s(e.$t("drug")))]),e._v(" "),t("v-select",{attrs:{options:e.drugOptions,filterable:!1,reduce:function(e){return e.id},label:"name"},on:{search:e.fetchDrugOptions},scopedSlots:e._u([{key:"search",fn:function(r){var n=r.attributes,o=r.events;return[t("input",e._g(e._b({staticClass:"vs__search",attrs:{required:!e.drugOrder.drug_id}},"input",n,!1),o))]}},{key:"option",fn:function(r){var n=r.name,image=r.image,o=r.price;return[t("div",{staticClass:"d-center"},[e._v("\n                        "+e._s(n)+"\n                        "),t("img",{attrs:{src:image,height:"70",width:"70"}}),e._v(" "),t("strong",[e._v("\n                          / "+e._s(o)+" L.E\n                        ")])])]}},{key:"selected-option",fn:function(r){var n=r.name,image=r.image,o=r.price;return[t("div",{staticClass:"selected d-center"},[t("strong",[e._v("\n                          "+e._s(n)+"\n                        ")]),e._v(" "),t("img",{attrs:{src:image,height:"70",width:"70"}}),e._v(" "),t("strong",[e._v("\n                          / "+e._s(o)+" L.E\n                        ")])])]}}],null,!1,3269669288),model:{value:e.drugOrder.drug_id,callback:function(r){e.$set(e.drugOrder,"drug_id",r)},expression:"drugOrder.drug_id"}})],1),e._v(" "),t("div",{staticClass:"form-group"},[t("LabelInputText",{attrs:{label:e.$t("quantity"),type:"number",name:"quantity",required:!0},model:{value:e.drugOrder.quantity,callback:function(r){e.$set(e.drugOrder,"quantity",r)},expression:"drugOrder.quantity"}})],1)])])],1)]),e._v(" "),t("div",{staticClass:"card card-body"},[t("b-table",{attrs:{items:e.order.drugs,fields:e.drugsFields,"show-empty":""},scopedSlots:e._u([{key:"cell(actions)",fn:function(data){return[t("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-center",modifiers:{"modal-center":!0}}],attrs:{variant:"info",size:"sm"},on:{click:function(r){return e.showDrugOrder(data.item.id)}}},[e._v("\n                "+e._s(e.$t("edit"))+"\n              ")]),e._v(" "),t("b-button",{attrs:{variant:"danger",size:"sm"},on:{click:function(r){return r.stopPropagation(),r.preventDefault(),e.deleteItem(data.item.id,r)}}},[e._v("\n                Delete\n              ")])]}}],null,!1,2227654826)})],1)]):e._e()])])],1)}),[],!1,null,"6641364d",null);r.default=component.exports},323:function(e,r,t){"use strict";t(11),t(9);var n={name:"LabelInputText",props:{label:{required:!1,default:"",type:String},value:{required:!1,type:[String,Number],default:""},type:{required:!0,default:"text",type:String},placeholder:{required:!1,default:"",type:String},name:{required:!0,type:String},required:{required:!1,default:!1,type:Boolean},disabled:{required:!1,default:!1,type:Boolean}},computed:{idName:function(){return this.label.toLowerCase().replace(" ","-")+"-"+Math.floor(100*Math.random())}},methods:{updateValue:function(e){this.$emit("input",e)}}},o=t(12),component=Object(o.a)(n,(function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"form-group"},[e.label?t("label",{staticClass:"col-form-label",attrs:{for:e.idName}},[e._v(e._s(e.label))]):e._e(),e._v(" "),t("div",{staticClass:"input-group mb-3"},[t("input",{staticClass:"form-control",attrs:{id:e.idName,name:e.name,type:e.type,placeholder:e.placeholder,required:e.required,disabled:e.disabled},domProps:{value:e.value},on:{input:function(r){return e.updateValue(r.target.value)}}})])])}),[],!1,null,null,null);r.a=component.exports},334:function(e,r,t){},347:function(e,r,t){"use strict";var n=t(334);t.n(n).a}}]);