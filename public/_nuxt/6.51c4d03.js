(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{112:function(e,t,r){"use strict";r.r(t);r(29);var n=r(10),o=r(330),c=r(334),l={name:"Orders",layout:"admin",middleware:"auth",head:function(){return{title:this.$t("orders")}},components:{LabelInputText:o.a,SubmitButton:c.a},data:function(){return{isBusy:!1,sortBy:"id",rows:1,perPage:0,currentPage:1,sortDesc:!0,fields:[{key:"uuid",sortable:!0},{key:"user",sortable:!0},{key:"area",sortable:!0},{key:"type",sortable:!0},{key:"items",sortable:!0},{key:"service_provider_type",sortable:!0},{key:"service_provider",sortable:!0},{key:"status",sortable:!0},{key:"created_at",sortable:!0},{key:"actions",sortable:!1}],query:{},filter:{uuid:"",service_provider_type_id:"",area_id:"",status:"",service_provider_id:"",user_id:""},orders:[],serviceProviderTypes:[],areas:[],userOptions:[],orderStatuses:[{id:"1",title:"تحت المراجعة"},{id:"2",title:"تم الموافقة"},{id:"3",title:"الطلب في الطريق"},{id:"4",title:"تم التوصيل"}],selectedArea:{id:"2",name:"Matrouh"}}},watch:{currentPage:{handler:function(e){this.query.page=this.currentPage,this.fetchData()}}},created:function(){this.fetchAreas(),this.fetchServiceProviderTypes(),this.fetchData()},mounted:function(){},methods:{fetchData:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.query.page||(e.$route.query.page?e.query.page=e.$route.query.page:e.query.page=e.currentPage),t.next=3,e.serializeRouterQuery();case 3:e.filter.user_id&&e.searchForUsers({user_id:e.filter.user_id}),e.callApi();case 5:case"end":return t.stop()}}),t)})))()},callApi:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isBusy=!0,t.next=3,e.$axios.$get("orders",{params:e.query}).then((function(t){e.rows=t.pagination.total,e.perPage=t.pagination.per_page,e.currentPage=t.pagination.current_page,e.orders=t.orders}));case 3:e.isBusy=!1,e.$router.push({name:"orders",query:e.query}).catch((function(){}));case 5:case"end":return t.stop()}}),t)})))()},getStatuses:function(){this.$axios.$get("order-statuses").then((function(e){}))},fetchServiceProviderTypes:function(){var e=this;this.$axios.$get("service-provider-types/all").then((function(t){e.serviceProviderTypes=t}))},fetchAreas:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.$get("areas/all").then((function(t){e.areas=t}));case 2:case"end":return t.stop()}}),t)})))()},deleteItem:function(e,t){t.preventDefault(),alert(e)},searchFilter:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.currentPage=1,t.next=3,e.serializeFilter();case 3:e.callApi();case 4:case"end":return t.stop()}}),t)})))()},serializeFilter:function(){for(var e in this.filter)this.query[e]=this.filter[e]},serializeRouterQuery:function(){for(var e in this.$route.query)this.filter.hasOwnProperty(e)&&this.$route.query[e]&&(this.query[e]=this.filter[e]=this.$route.query[e])},listenToNewOrder:function(){var e=this;this.$echo.channel("new-order").listen("NewOrder",(function(t){e.orders.push(t)}))},fetchUserOptions:function(e,t){var r=this;0!==e.length&&(t(!0),setTimeout((function(){r.searchForUsers({identifier:e}),t(!1)}),300))},searchForUsers:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$axios.$get("users",{params:e}).then((function(e){t.userOptions=e.users}));case 2:case"end":return r.stop()}}),r)})))()}}},d=(r(354),r(12)),component=Object(d.a)(l,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("header-info",{attrs:{name:"orders",navigation:[{name:"home",link:"dashboard"},{name:"orders",link:""}]}}),e._v(" "),r("section",{staticClass:"filter content"},[r("form",{attrs:{role:"form"},on:{submit:function(t){return t.preventDefault(),e.searchFilter()}}},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-2"},[r("label-input-text",{attrs:{label:e.$t("order_uuid"),type:"number",placeholder:"Enter UUID",name:"uuid"},model:{value:e.filter.uuid,callback:function(t){e.$set(e.filter,"uuid",t)},expression:"filter.uuid"}})],1),e._v(" "),r("div",{staticClass:"col-2"},[r("label",{attrs:{id:"users"}},[e._v(e._s(e.$t("user")))]),e._v(" "),r("v-select",{attrs:{dir:"rtl",options:e.userOptions,filterable:!1,reduce:function(e){return e.id},label:"name",placeholder:"ابحث باسم المستخدم او رقم الهاتف"},on:{search:e.fetchUserOptions},scopedSlots:e._u([{key:"option",fn:function(t){var n=t.name;return[r("div",{staticClass:"d-center"},[e._v("\n                "+e._s(n)+"\n              ")])]}},{key:"selected-option",fn:function(t){var n=t.name;return[r("div",{staticClass:"selected d-center"},[r("strong",[e._v("\n                  "+e._s(e.userOptions.find((function(t){return t.id==e.filter.user_id}))?e.userOptions.find((function(t){return t.id==e.filter.user_id})).name:n)+"\n                ")])])]}}]),model:{value:e.filter.user_id,callback:function(t){e.$set(e.filter,"user_id",t)},expression:"filter.user_id"}})],1),e._v(" "),r("div",{staticClass:"col-2"},[r("label",[e._v(e._s(e.$t("service_provider_type")))]),e._v(" "),r("v-select",{attrs:{dir:"rtl",options:e.serviceProviderTypes,reduce:function(e){return e.id},label:"title",placeholder:e.$t("select")+" "+e.$t("service_provider")},scopedSlots:e._u([{key:"selected-option",fn:function(t){var title=t.title;return[r("div",{staticClass:"d-center"},[e._v("\n                "+e._s(e.serviceProviderTypes.find((function(t){return t.id==e.filter.service_provider_type_id}))?e.serviceProviderTypes.find((function(t){return t.id==e.filter.service_provider_type_id})).title:title)+"\n              ")])]}}]),model:{value:e.filter.service_provider_type_id,callback:function(t){e.$set(e.filter,"service_provider_type_id",t)},expression:"filter.service_provider_type_id"}})],1),e._v(" "),r("div",{staticClass:"col-2"},[r("label",[e._v(e._s(e.$t("area")))]),e._v(" "),r("v-select",{attrs:{dir:"rtl",options:e.areas,reduce:function(area){return area.id},label:"name",placeholder:e.$t("select")+" "+e.$t("area")},scopedSlots:e._u([{key:"selected-option",fn:function(t){var n=t.name;return[r("div",{staticClass:"d-center"},[e._v("\n                "+e._s(e.areas.find((function(area){return area.id==e.filter.area_id}))?e.areas.find((function(area){return area.id==e.filter.area_id})).name:n)+"\n              ")])]}}]),model:{value:e.filter.area_id,callback:function(t){e.$set(e.filter,"area_id",t)},expression:"filter.area_id"}})],1),e._v(" "),r("div",{staticClass:"col-2"},[r("label",[e._v(e._s(e.$t("status")))]),e._v(" "),r("v-select",{attrs:{dir:"rtl",options:e.orderStatuses,reduce:function(e){return e.id},label:"title",placeholder:e.$t("select")+" "+e.$t("status")},model:{value:e.filter.status,callback:function(t){e.$set(e.filter,"status",t)},expression:"filter.status"}})],1)]),e._v(" "),r("submit-button")],1)]),e._v(" "),r("section",{staticClass:"content"},[r("div",{staticClass:"container-fluid"},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-sm-12"},[r("div",{staticClass:"card card-primary"},[r("div",{staticClass:"card-header"},[r("n-link",{attrs:{to:{name:"create-service-provider"}}},[r("button",{staticClass:"btn btn-outline-light float-left"},[e._v("\n                  "+e._s(e.$t("add_new"))+"\n                ")])])],1),e._v(" "),r("div",{staticClass:"card card-body"},[r("b-table",{attrs:{items:e.orders,busy:e.isBusy,fields:e.fields,"sort-by":e.sortBy,"sort-desc":e.sortDesc,"per-page":"0","current-page":e.currentPage,responsive:"sm",hover:"",striped:"","show-empty":"",stacked:"md"},on:{"update:busy":function(t){e.isBusy=t},"update:sortBy":function(t){e.sortBy=t},"update:sort-by":function(t){e.sortBy=t},"update:sortDesc":function(t){e.sortDesc=t},"update:sort-desc":function(t){e.sortDesc=t}},scopedSlots:e._u([{key:"table-busy",fn:function(){return[r("div",{staticClass:"text-center text-primary my-2"},[r("b-spinner",{staticClass:"align-middle",attrs:{variant:"primary"}}),e._v(" "),r("strong",[e._v("تحميل...")])],1)]},proxy:!0},{key:"cell(user)",fn:function(data){return[r("span",[e._v(e._s(data.item.user.name))])]}},{key:"cell(type)",fn:function(data){return[r("span",[e._v(e._s(data.item.type))])]}},{key:"cell(services)",fn:function(data){return[r("span",[e._v(e._s(data.item.items))])]}},{key:"cell(service_provider)",fn:function(data){return[data.item.service_provider?r("span",[e._v(e._s(data.item.service_provider.name))]):e._e()]}},{key:"cell(status)",fn:function(data){return[1==data.item.status.code?r("b-badge",{attrs:{variant:"warning"}},[e._v("\n                    "+e._s(data.item.status.string)+"\n                  ")]):e._e(),e._v(" "),2==data.item.status.code?r("b-badge",{attrs:{variant:"primary"}},[e._v("\n                    "+e._s(data.item.status.string)+"\n                  ")]):3==data.item.status.code?r("b-badge",{attrs:{variant:"secondary"}},[e._v("\n                    "+e._s(data.item.status.string)+"\n                  ")]):4==data.item.status.code?r("b-badge",{attrs:{variant:"success"}},[e._v("\n                    "+e._s(data.item.status.string)+"\n                  ")]):e._e()]}},{key:"cell(created_at)",fn:function(data){return[data.item.created_at?r("span",[e._v("\n                    "+e._s(e.$moment(String(data.item.created_at),"YYYY-MM-DD hh:mm:ss").format("LLLL"))+"\n                  ")]):e._e()]}},{key:"cell(actions)",fn:function(data){return[r("b-button",{attrs:{to:{name:"show-order",params:{id:data.item.id}},variant:"info",size:"sm"}},[e._v("\n                    Show\n                  ")]),e._v(" "),r("b-button",{attrs:{to:{name:"edit-order",params:{id:data.item.id}},variant:"secondary",size:"sm"}},[e._v("\n                    Edit\n                  ")])]}}])})],1)]),e._v(" "),r("b-pagination",{attrs:{"total-rows":e.rows,"per-page":e.perPage},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}})],1)])])])],1)}),[],!1,null,null,null);t.default=component.exports},330:function(e,t,r){"use strict";r(11),r(9);var n={name:"LabelInputText",props:{label:{required:!1,default:"",type:String},value:{required:!1,type:[String,Number],default:""},type:{required:!0,default:"text",type:String},placeholder:{required:!1,default:"",type:String},name:{required:!0,type:String},required:{required:!1,default:!1,type:Boolean},disabled:{required:!1,default:!1,type:Boolean}},computed:{idName:function(){return this.label.toLowerCase().replace(" ","-")+"-"+Math.floor(100*Math.random())}},methods:{updateValue:function(e){this.$emit("input",e)}}},o=r(12),component=Object(o.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"form-group"},[e.label?r("label",{staticClass:"col-form-label",attrs:{for:e.idName}},[e._v(e._s(e.label))]):e._e(),e._v(" "),r("div",{staticClass:"input-group mb-3"},[r("input",{staticClass:"form-control",attrs:{id:e.idName,name:e.name,type:e.type,placeholder:e.placeholder,required:e.required,disabled:e.disabled},domProps:{value:e.value},on:{input:function(t){return e.updateValue(t.target.value)}}})])])}),[],!1,null,null,null);t.a=component.exports},334:function(e,t,r){"use strict";var n={name:"SubmitButton"},o=r(12),component=Object(o.a)(n,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"row"},[t("b-col",{staticClass:"pb-2",attrs:{lg:"4"}},[t("b-button",{attrs:{size:"lg",variant:"success",type:"submit"}},[this._v("\n      "+this._s(this.$t("search"))+"\n    ")])],1)],1)}),[],!1,null,null,null);t.a=component.exports},341:function(e,t,r){},354:function(e,t,r){"use strict";var n=r(341);r.n(n).a}}]);